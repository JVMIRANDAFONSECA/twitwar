(this.webpackJsonptwitwat=this.webpackJsonptwitwat||[]).push([[0],{178:function(e,t,n){},179:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(58),i=n.n(o),s=n(5),c=n.n(s),l=n(14),u=n(15),m=n(63),d=n(27),p=function(){return window.history.replaceState({},document.title,window.location.pathname)},h=r.a.createContext(),b=function(){return Object(a.useContext)(h)},f=function(e){var t=e.children,n=e.onRedirectCallback,o=void 0===n?p:n,i=Object(m.a)(e,["children","onRedirectCallback"]),s=Object(a.useState)(),b=Object(u.a)(s,2),f=b[0],v=b[1],g=Object(a.useState)(),k=Object(u.a)(g,2),O=k[0],w=k[1],E=Object(a.useState)(),y=Object(u.a)(E,2),j=y[0],C=y[1],A=Object(a.useState)(!0),S=Object(u.a)(A,2),x=S[0],L=S[1],N=Object(a.useState)(!1),R=Object(u.a)(N,2),U=R[0],W=R[1];Object(a.useEffect)((function(){(function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.a)(i);case 2:if(t=e.sent,C(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:n=e.sent,a=n.appState,o(a);case 10:return e.next=12,t.isAuthenticated();case 12:if(r=e.sent,v(r),!r){e.next=19;break}return e.next=17,t.getUser();case 17:s=e.sent,w(s);case 19:L(!1);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var P=function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,a=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},W(!0),e.prev=2,e.next=5,j.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,W(!1),e.finish(10);case 13:return e.next=15,j.getUser();case 15:n=e.sent,w(n),v(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.next=3,j.handleRedirectCallback();case 3:return e.next=5,j.getUser();case 5:t=e.sent,L(!1),v(!0),w(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(h.Provider,{value:{isAuthenticated:f,user:O,loading:x,popupOpen:U,loginWithPopup:P,handleRedirectCallback:T,getIdTokenClaims:function(){return j.getIdTokenClaims.apply(j,arguments)},loginWithRedirect:function(){return j.loginWithRedirect.apply(j,arguments)},getTokenSilently:function(){return j.getTokenSilently.apply(j,arguments)},getTokenWithPopup:function(){return j.getTokenWithPopup.apply(j,arguments)},logout:function(){return j.logout.apply(j,arguments)}}},t)},v=function(){var e=b(),t=e.isAuthenticated,n=e.loginWithRedirect,a=e.logout;return r.a.createElement("nav",{class:"navbar navbar-light bg-light"},r.a.createElement("div",null,!t&&r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return n({})}},"Log in"),t&&r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return a()}},"Log out")),r.a.createElement("h6",null,"TwitWars"))},g=n(8),k=n(9),O=n(11),w=n(10),E=function(){var e=b(),t=e.loading,n=e.user;return t||!n?r.a.createElement("div",null,"Loading..."):r.a.createElement(a.Fragment,null,r.a.createElement("h2",null,"Welcome, ",n.name,"!"))},y=function(e){Object(O.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).handleClickAgree=function(e){a.props.polarity(!0),a.props.lobby(e),a.props.setOpinion(!0),fetch("https://twit-war.herokuapp.com/api/room?trend="+e+"&opinion=true").then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({isLoaded:!0,room:e}),a.props.setRoom(a.state.room)}),(function(e){a.setState({isLoaded:!0,error:e})}))},a.handleClickDisagree=function(e){a.props.polarity(!1),a.props.lobby(e),a.props.setOpinion(!0),fetch("https://twit-war.herokuapp.com/api/room?trend="+e+"&opinion=false").then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({isLoaded:!0,room:e}),a.props.setRoom(a.state.room)}),(function(e){a.setState({isLoaded:!0,error:e})}))},a}return Object(k.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.trends,a=t.username,o=n.map((function(t){return r.a.createElement("div",{className:"trendContainer my-5",key:t.id},r.a.createElement("div",null,r.a.createElement("h5",null,t.name),t.tweet_volume?r.a.createElement("p",{className:"text-muted"},t.tweet_volume," tweets"):null),r.a.createElement("div",{className:"buttonContainer"},r.a.createElement("button",{className:"btn btn-success m-2",onClick:function(){e.handleClickAgree(t.name)}},"Agree"),r.a.createElement("button",{className:"btn btn-danger  m-2",onClick:function(){e.handleClickDisagree(t.name)}},"Disagree")))}));return a.trim()&&!this.props.opinion?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"jumbotron"},r.a.createElement(E,null),o)):null}}]),n}(r.a.Component),j=n(20),C=function(e){Object(O.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).onLoginAttempt=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.a)({domain:"twitwar.eu.auth0.com",client_id:"g7vWpCLneLdOPUeRx5KHeskBEwbcPQUa"});case 2:return t=e.sent,e.next=5,t.loginWithRedirect({redirect_uri:"https://ojaoc.github.io/hackertrollerz-ui/"});case 5:console.log(t);case 6:case"end":return e.stop()}}),e)}))),a.state={username:""},a.handleChange=a.handleChange.bind(Object(j.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(j.a)(a)),a}return Object(k.a)(n,[{key:"handleChange",value:function(e){this.setState({username:e.target.value})}},{key:"handleSubmit",value:function(e){this.props.setUsername(this.state.username),e.preventDefault()}},{key:"render",value:function(){return this.props.username.trim()?null:r.a.createElement("div",{className:"jumbotron centered"},r.a.createElement("div",{className:"form-group"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"p-2"},"Username:",r.a.createElement("input",{className:"form-control",type:"text",value:this.state.username,onChange:this.handleChange})),r.a.createElement("input",{type:"submit",value:"Submit",className:"btn btn-primary"})))))}}]),n}(r.a.Component),A=n(62),S=n(59),x=n.n(S),L=n(60),N=function(e){Object(O.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).onMessageReceive=function(e,t){var n={author:e.sender,message:e.content};a.setState((function(e){return{messages:[].concat(Object(A.a)(e.messages),[n])}}))},a.sendMessage=function(e,t){try{var n={sender:a.props.username,content:t.message,type:"CHAT"};return console.log(n),a.clientRef.sendMessage("/trend/"+a.props.room,JSON.stringify(n)),!0}catch(r){return!1}},a.handleExit=function(){fetch("https://twit-war.herokuapp.com/api/leave?roomId="+a.props.room+"&trend="+a.props.lobby,{method:"POST"})},a.handleClick=function(){a.props.setOpinion(!1),a.handleExit()},a.state={error:null,isLoaded:!1,clientConnected:!1,messages:[],room:null},a}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(){return e.handleExit()}))}},{key:"render",value:function(){var e=this;return this.props.opinion?r.a.createElement("div",{className:"jumbotron centered"},r.a.createElement("div",null,r.a.createElement(L.TalkBox,{topic:this.props.lobby,currentUserId:this.randomUserId,currentUser:this.randomUserName,messages:this.state.messages,onSendMessage:this.sendMessage,connected:this.state.clientConnected}),r.a.createElement(x.a,{url:"https://twit-war.herokuapp.com/ws",topics:["/trend/"+this.props.room],onMessage:this.onMessageReceive,ref:function(t){e.clientRef=t},onConnect:function(){e.setState({clientConnected:!0})},onDisconnect:function(){e.setState({clientConnected:!1})},debug:!1}),r.a.createElement("button",{className:"btn btn-primary",onClick:this.handleClick},"Exit"))):null}}]),n}(r.a.Component),R=function(e){Object(O.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).setUser=function(e){a.setState({username:e})},a.setHasClickedOpinion=function(e){a.setState({hasClickedOpinion:e})},a.setLobby=function(e){a.setState({lobby:e})},a.setPolarity=function(e){a.setState({polarity:e})},a.setRoom=function(e){a.setState({room:e})},a.state={username:"",error:null,isLoaded:!1,trends:[],hasClickedOpinion:!1,lobby:"",polarity:null,room:null},a}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("https://twit-war.herokuapp.com/api/trends?bt=AAAAAAAAAAAAAAAAAAAAAC2uDwEAAAAAuUTw%2FQnHL9lqek0ODTp64ROuGBU%3D7fwFkHZVgPMjz3FdOVhZlsE7idVKtyI2kJj6zofXQx8JduNHvh").then((function(e){return e.json()})).then((function(t){e.setState({isLoaded:!0,trends:t[0].trends})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoaded;e.trends;return t?r.a.createElement("div",null,"Error: ",t.message):n?(console.log(this.state.trends),r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{setUsername:this.setUser,username:this.state.username}),r.a.createElement(y,{trends:this.state.trends,username:this.state.username,setOpinion:this.setHasClickedOpinion,opinion:this.state.hasClickedOpinion,polarity:this.setPolarity,lobby:this.setLobby,setRoom:this.setRoom}),r.a.createElement(N,{username:this.state.username,setOpinion:this.setHasClickedOpinion,opinion:this.state.hasClickedOpinion,polarity:this.state.polarity,lobby:this.state.lobby,room:this.state.room}))):r.a.createElement("div",null,"Loading...")}}]),n}(r.a.Component);var U=function(){return b().loading?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",{className:"App"},r.a.createElement("header",null,r.a.createElement(v,null),r.a.createElement(R,null)))};n(177),n(178),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=n(36),P=n(61),T=Object(P.a)();i.a.render(r.a.createElement(f,{domain:W.domain,client_id:W.clientId,redirect_uri:window.location.origin,onRedirectCallback:function(e){T.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},36:function(e){e.exports=JSON.parse('{"domain":"twitwar.eu.auth0.com","clientId":"g7vWpCLneLdOPUeRx5KHeskBEwbcPQUa"}')},64:function(e,t,n){e.exports=n(179)}},[[64,1,2]]]);
//# sourceMappingURL=main.26436ad8.chunk.js.map